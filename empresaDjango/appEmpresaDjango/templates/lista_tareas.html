{% extends 'base.html' %}
{% load static %}

{% block contenido %}
        <div id = "page">
            <div id = "page_text">
                
              <h2>TAREAS</h2>

            </div>
            <div id= "tabla">
                <table class="tablapla">
                    <tr>
                        <th class="tittabla">Nombre</th>
                        <th class="tittabla">Proyecto</th>
                        <th class="tittabla">Fecha de inicio</th>
                        <th class="tittabla">Fecha fin</th>
                        <th class="tittabla">Ver m√°s</th>
                        <th class="tittabla">Finalizar</th>
                    </tr>
                    {% for a in lista_tareas %}
                        <tr>
                            <td class="comptab">{{ a.nombre }}</td>
                            <td class="comptab">{{ a.proyecto }}</td>
                            <td class="comptab">{{ a.inicio }}</td>
                            <td class="comptab">{{ a.fin }}</td>
                            <td class="comptab"><a href="{% url 'tareaun' a.id %}" class= "boton_borrar">
                                <img src="{% static 'ojo.png' %}"></a></td>
                            <td class="comptab"><button id="fin{{a.id}}">FINALIZAR</button></td>
                            
                        </tr>
                        <script>
                        
                        var elem = document.getElementById('fin{{a.id}}');
                        elem.style.backgroundColor ="red";
                        elem.onclick = finalizar;
                        
                        function finalizar()
                        {
                            var id = "{{a.id}}"
                            fetch('http://127.0.0.1:8000/appEmpresaDjango/tareas/' + id, {
                            method: 'DELETE',
                            pk:id
                            })
                            .then(res => res.text()) // or res.json()
                            alert("La tarea {{ a.nombre }} del proyecto {{a.proyecto}} ha sido eliminada!");

                        }

                        
                    </script>
                    {% endfor %}
                    
                </table>
            </div>
        </div>


{% endblock %}